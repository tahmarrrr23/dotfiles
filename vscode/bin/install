#!/bin/sh
set -eu
cd "$(dirname "$0")"
root="$(dirname "$(pwd)")"
[ ! -d "/opt/homebrew" ] && echo "please install homebrew" && exit 1

# install from brew
/opt/homebrew/bin/brew install visual-studio-code

# restore from backup
/opt/homebrew/bin/brew bundle \
  --vscode \
  --no-lock \
  --force \
  --file="$root/Brewfile"

# linking settings
ln \
  -s \
  -f "$root/settings.json" "$HOME/Library/Application Support/Code/User/settings.json"
